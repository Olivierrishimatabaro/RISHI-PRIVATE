-- HC12T9 : Lecture et analyse d'un fichier
-- Auteur : Olivier
-- Ã‰crit pour moi-mÃªme afin de me souvenir de comment lire un fichier
-- et analyser un peu son contenu en Haskell.
-- Ici, je simule le fichier pour pouvoir tester en ligne.

import Data.Time

main :: IO ()
main = do
    -- Je commence par noter l'heure Ã  laquelle j'exÃ©cute ce code
    putStrLn "----------------------------------------"
    putStrLn "ðŸ“˜ Mon petit programme Haskell"
    putStrLn "Lecture et analyse d'un fichier"
    putStrLn "----------------------------------------"

    now <- getCurrentTime
    putStrLn $ "â° ExÃ©cutÃ© le : " ++ show now
    putStrLn ""

    -- Comme je n'ai pas de fichier rÃ©el ici, je crÃ©e un contenu simulÃ©
    let monFichier = "monfichier.txt"
    let contenu = unlines
          [ "Salut Olivier !"
          , "Ceci est mon fichier simulÃ© pour tester Haskell."
          , "Je veux m'assurer que je peux lire le contenu et compter les mots et lignes."
          , "Tout fonctionne comme si c'Ã©tait un vrai fichier."
          , "C'est pratique pour tester rapidement."
          , "Amuse-toi bien Ã  modifier ce texte ou Ã  tester autre chose !"
          ]

    putStrLn ("ðŸ“‚ Lecture du fichier : " ++ monFichier)
    putStrLn "\n--- Contenu ---"
    putStrLn contenu

    -- Je calcule quelques statistiques rapides pour moi-mÃªme
    let nbLignes = length (lines contenu)
    let nbMots   = length (words contenu)
    let nbChars  = length contenu

    putStrLn "----------------------------"
    putStrLn $ "Nombre de lignes : " ++ show nbLignes
    putStrLn $ "Nombre de mots   : " ++ show nbMots
    putStrLn $ "Nombre de caractÃ¨res : " ++ show nbChars
    putStrLn "----------------------------"

    -- Et je fais quelques vÃ©rifications pour moi-mÃªme
    putStrLn "\nðŸ”Ž VÃ©rifications rapides :"
    if "Haskell" `elem` words contenu
        then putStrLn "âœ… Le mot 'Haskell' est bien prÃ©sent, comme je m'y attendais."
